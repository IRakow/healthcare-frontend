import{r as p,s as a,j as t,C as _}from"./index-BshQ_n5L.js";function $(){const[l,h]=p.useState({appointments:0,completed:0,aiUsed:0,overdue:0}),[x,u]=p.useState([]);return p.useEffect(()=>{(async()=>{const s=a.auth.user(),{count:n}=await a.from("appointments").select("*",{count:"exact",head:!0}).eq("provider_id",s.id),{count:b}=await a.from("appointments").select("*",{count:"exact",head:!0}).eq("provider_id",s.id).eq("status","complete"),{count:f}=await a.from("ai_logs").select("*",{count:"exact",head:!0}).eq("user_id",s.id),{count:w}=await a.from("appointments").select("*",{count:"exact",head:!0}).eq("provider_id",s.id).eq("status","pending");h({appointments:n||0,completed:b||0,aiUsed:f||0,overdue:w||0});const{data:d}=await a.from("vitals").select("*"),g=(d==null?void 0:d.filter(e=>e.bp_systolic>160||e.temp>102))||[],{data:r}=await a.from("medications").select("*"),j=(r==null?void 0:r.filter(e=>e.missed_doses>3))||[],{data:c}=await a.from("appointments").select("*"),m=new Date;m.setDate(m.getDate()-90);const N=(c==null?void 0:c.filter(e=>new Date(e.date)<m&&e.status!=="complete"))||[],o=[];g.forEach((e,i)=>{e.bp_systolic>160&&o.push({id:`vital-${i}`,patient_id:e.patient_id,label:"Abnormal blood pressure",reason:`BP ${e.bp_systolic}/${e.bp_diastolic||"??"}`,patient:{name:"Emily Turner"}}),e.temp>102&&o.push({id:`temp-${i}`,patient_id:e.patient_id,label:"High fever",reason:`Temperature ${e.temp}°F`,patient:{name:"Patient "+(i+1)}})}),j.forEach((e,i)=>{o.push({id:`med-${i}`,patient_id:e.patient_id,label:`Missed meds x${e.missed_doses}`,reason:`${e.name} - Non-compliance`,patient:{name:"Leo Chavez"}})}),N.forEach((e,i)=>{const v=Math.floor((new Date().getTime()-new Date(e.date).getTime())/864e5);o.push({id:`overdue-${i}`,patient_id:e.patient_id,label:`No follow-up in ${v} days`,reason:`Last visit: ${new Date(e.date).toLocaleDateString()}`,patient:{name:"Sophia Lane"}})}),u(o.slice(0,3))})()},[]),t.jsxs("div",{className:"p-6 max-w-screen-lg mx-auto space-y-6",children:[t.jsx("h1",{className:"text-3xl font-bold text-blue-700",children:"📈 My Clinical Dashboard"}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"rounded-2xl border bg-white/80 backdrop-blur p-6 shadow-xl hover:shadow-2xl transition-all",children:[t.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Total Appointments"}),t.jsx("p",{className:"text-2xl font-semibold",children:l.appointments})]}),t.jsxs("div",{className:"rounded-2xl border bg-white/80 backdrop-blur p-6 shadow-xl hover:shadow-2xl transition-all",children:[t.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Completed Visits"}),t.jsx("p",{className:"text-2xl font-semibold",children:l.completed})]}),t.jsxs("div",{className:"rounded-2xl border bg-white/80 backdrop-blur p-6 shadow-xl hover:shadow-2xl transition-all",children:[t.jsx("h3",{className:"text-lg font-semibold mb-2",children:"AI SOAP Notes Created"}),t.jsx("p",{className:"text-2xl font-semibold",children:l.aiUsed})]}),t.jsxs("div",{className:"rounded-2xl border bg-white/80 backdrop-blur p-6 shadow-xl hover:shadow-2xl transition-all",children:[t.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Overdue Visits"}),t.jsx("p",{className:"text-2xl font-semibold text-red-600",children:l.overdue})]})]}),t.jsx(_,{title:"⚠️ Patient Risk Flags",children:x.length===0?t.jsx("p",{className:"text-sm text-gray-500",children:"No active risk flags"}):t.jsx("ul",{className:"text-sm space-y-2",children:x.map(s=>{var n;return t.jsxs("li",{className:"flex justify-between",children:[t.jsx("span",{children:((n=s.patient)==null?void 0:n.name)||"Unknown Patient"}),t.jsx("span",{className:s.label.includes("blood pressure")?"text-red-600":s.label.includes("meds")?"text-orange-500":"text-yellow-600",children:s.label})]},s.id)})})})]})}export{$ as default};
